<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alessandro de Castro Corrêa">
<meta name="author" content="Gabriel Henrique Gomes de Souza">

<title>MINICURSO CONNEPI 2024: Regressão Linear para pesquisa tecnológica com apoio do R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#apresentação" id="toc-apresentação" class="nav-link active" data-scroll-target="#apresentação"><span class="header-section-number">1</span> Apresentação</a></li>
  <li><a href="#por-que-regressão" id="toc-por-que-regressão" class="nav-link" data-scroll-target="#por-que-regressão"><span class="header-section-number">2</span> Por que regressão?</a></li>
  <li><a href="#o-modelo-de-regressão" id="toc-o-modelo-de-regressão" class="nav-link" data-scroll-target="#o-modelo-de-regressão"><span class="header-section-number">3</span> O modelo de regressão</a>
  <ul class="collapse">
  <li><a href="#definição-do-modelo" id="toc-definição-do-modelo" class="nav-link" data-scroll-target="#definição-do-modelo"><span class="header-section-number">3.1</span> Definição do modelo</a></li>
  <li><a href="#predição-de-valores" id="toc-predição-de-valores" class="nav-link" data-scroll-target="#predição-de-valores"><span class="header-section-number">3.2</span> Predição de valores</a></li>
  <li><a href="#os-resíduos" id="toc-os-resíduos" class="nav-link" data-scroll-target="#os-resíduos"><span class="header-section-number">3.3</span> Os resíduos</a></li>
  <li><a href="#teste-dos-parâmetros" id="toc-teste-dos-parâmetros" class="nav-link" data-scroll-target="#teste-dos-parâmetros"><span class="header-section-number">3.4</span> Teste dos parâmetros</a></li>
  </ul></li>
  <li><a href="#regressão-no-r" id="toc-regressão-no-r" class="nav-link" data-scroll-target="#regressão-no-r"><span class="header-section-number">4</span> Regressão no R</a>
  <ul class="collapse">
  <li><a href="#o-que-é-o-r" id="toc-o-que-é-o-r" class="nav-link" data-scroll-target="#o-que-é-o-r"><span class="header-section-number">4.1</span> O que é o R?</a></li>
  <li><a href="#o-diretório-de-trabalho" id="toc-o-diretório-de-trabalho" class="nav-link" data-scroll-target="#o-diretório-de-trabalho"><span class="header-section-number">4.2</span> O diretório de trabalho</a></li>
  <li><a href="#lendo-e-examinando-dados-no-r" id="toc-lendo-e-examinando-dados-no-r" class="nav-link" data-scroll-target="#lendo-e-examinando-dados-no-r"><span class="header-section-number">4.3</span> Lendo e examinando dados no R</a></li>
  <li><a href="#predizendo-valores-no-r" id="toc-predizendo-valores-no-r" class="nav-link" data-scroll-target="#predizendo-valores-no-r"><span class="header-section-number">4.4</span> Predizendo valores no R</a></li>
  </ul></li>
  <li><a href="#qualidade-do-ajuste" id="toc-qualidade-do-ajuste" class="nav-link" data-scroll-target="#qualidade-do-ajuste"><span class="header-section-number">5</span> Qualidade do ajuste</a></li>
  <li><a href="#pressupostos-do-modelo-de-regressão" id="toc-pressupostos-do-modelo-de-regressão" class="nav-link" data-scroll-target="#pressupostos-do-modelo-de-regressão"><span class="header-section-number">6</span> Pressupostos do Modelo de Regressão</a>
  <ul class="collapse">
  <li><a href="#os-pressupostos" id="toc-os-pressupostos" class="nav-link" data-scroll-target="#os-pressupostos"><span class="header-section-number">6.1</span> Os pressupostos</a></li>
  <li><a href="#avaliação-dos-pressupostos" id="toc-avaliação-dos-pressupostos" class="nav-link" data-scroll-target="#avaliação-dos-pressupostos"><span class="header-section-number">6.2</span> Avaliação dos pressupostos</a></li>
  </ul></li>
  <li><a href="#o-modelo-final" id="toc-o-modelo-final" class="nav-link" data-scroll-target="#o-modelo-final"><span class="header-section-number">7</span> O modelo final</a></li>
  <li><a href="#praticando" id="toc-praticando" class="nav-link" data-scroll-target="#praticando"><span class="header-section-number">8</span> Praticando</a></li>
  <li><a href="#multicolinearidade" id="toc-multicolinearidade" class="nav-link" data-scroll-target="#multicolinearidade"><span class="header-section-number">9</span> Multicolinearidade</a></li>
  <li><a href="#trabalhos-com-regressão" id="toc-trabalhos-com-regressão" class="nav-link" data-scroll-target="#trabalhos-com-regressão"><span class="header-section-number">10</span> Trabalhos com regressão</a></li>
  <li><a href="#referências" id="toc-referências" class="nav-link" data-scroll-target="#referências">Referências</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MINICURSO CONNEPI 2024: Regressão Linear para pesquisa tecnológica com apoio do R</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autores</div>
  <div class="quarto-title-meta-heading">Afiliações</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Alessandro de Castro Corrêa <a href="mailto:alessandro.correa@ifpa.edu.br" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Professor - IFPA
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Gabriel Henrique Gomes de Souza <a href="mailto:eng.gabriel.gsouza@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Bolsista PIBICTI/PROPPG/IFPA/CNPq
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="apresentação" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Apresentação</h1>
<p>Este é uma material de apoio do Minicurso: <strong>Regressão Linear para pesquisa tecnológica com apoio do R</strong> ministrado no XIV Congresso Norte Nordeste de Pesquisa e Inovação (<a href="https://www.even3.com.br/connepi-belem-2024/" class="external" target="_blank">CONNEPI</a>), realizado em Belém/PA, em agosto de 2024.</p>
<p>Além das breves explicações destinadas a complementar uma introdução ao modelo de regressão realizada em sala de aula, são disponibilizados os códigos em R e os dados utilizados.</p>
<p>O minicurso foi elaborado a partir das necessidades observadas nas atividades de pesquisa do Grupo de Estudos Aplicados em Gestão (<a href="https://dgp.cnpq.br/dgp/espelhogrupo/34781" class="external" target="_blank">GEAG</a>), nas aulas das disciplinas Planejamento Estatístico e Experimental, do Mestrado em Engenharia de Materiais (<a href="https://belem.ifpa.edu.br/ppgemat" class="external" target="_blank">PPGEMAT</a>), de Estatística aplicada, na Engenharia de Materiais e de Métodos Quantitativos, ministrada nos cursos de Tecnologia em Gestão Pública, em Gestão Hospitalar e em Análise e Desenvolvimento de Sistemas do IFPA.</p>
<p>O modelo de regressão é certamente uma das técnicas estatísticas mais utilizadas em análise de dados, com amplas possibilidades de aplicação em desenvovimento de novas tecnologias e este minicurso é uma introdução gentil ao tema. Espero que aproveitem.</p>
</section>
<section id="por-que-regressão" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Por que regressão?</h1>
<ul>
<li>Inovação tecnológica envolve propor novas soluções ou aprimoramentos resolver problemas.</li>
<li>Um resultado de um processo ou propriedade de algo pode ser entedido como uma variável que pode ser explicada por outra ou por outras variáveis.</li>
<li>Posso descrever ou estimar o resultado dessa relação?</li>
<li>Como posso melhorar as propriedades de materiais ou de um sistema, conhecendo a sua relação com os principais fatores envolvidos?</li>
<li>Como realizar os cálculos e gráficos dessas análise sem despesas?</li>
</ul>
</section>
<section id="o-modelo-de-regressão" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> O modelo de regressão</h1>
<section id="definição-do-modelo" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="definição-do-modelo"><span class="header-section-number">3.1</span> Definição do modelo</h2>
<p>A <strong>regressão</strong> é uma técnica utilizada para explicar e modelar a relação entre uma variável <em>y</em> , denominada resposta ou variável dependente, e uma ou mais variáveis independentes, também denominadas fatores ou variáveis explicativas, <em>x1</em>,…,<em>xk</em> <span class="citation" data-cites="faraway2002practical">(<a href="#ref-faraway2002practical" role="doc-biblioref">Faraway, 2002</a>)</span>.</p>
<p><span class="math display">\[y = f(x_1, x_2, \dots, x_k)\]</span></p>
<p>A variável dependente deve ser contínua, mas a(s) variável(is) independentes de podem ser contínuas, discretas ou categóricas.</p>
<p>A regressão pode ser utilizadas para três finalidades básicas:</p>
<ol type="a">
<li><strong>Descrição</strong>: descrever a estrutura geral de dados;</li>
<li><strong>Análise</strong>:Analisar os efeitos de variações nas variáveis independentes ou fatores sobre a variável dependente ou resposta; e</li>
<li><strong>Previsão</strong>: estimar valores da variável dependente com base nos valores das variáveis independentes.</li>
</ol>
<p>A regressão busca explicar porque os valores de cada uma das observações de <span class="math inline">\(y\)</span> são diferentes umas das outras com base na informação dos valores de <span class="math inline">\(x\)</span> associados. O valor esperado de cada <span class="math inline">\(y\)</span> para cada valor de <span class="math inline">\(x\)</span>, ou valor condicional de y, pode ser descrito inicialmente pelo seguinte modelo:</p>
<p><span class="math display">\[E(y|x)=\beta_0+\beta_1X + \epsilon\]</span></p>
<p>em que o intercepto <span class="math inline">\(\beta_0\)</span> e ao coeficiente de inclinação <span class="math inline">\(\beta_i\)</span> são constantes desconhecidas e <span class="math inline">\(\epsilon\)</span> é uma compontente aleatória.</p>
<p>A <a href="#fig-reta" class="quarto-xref">Figura&nbsp;1</a> (a) apresenta um conjunto de observações de uma variável dependente (<em>y</em>) em resposta a diferentes valores de uma variável independente (<em>X</em>). Na <a href="#fig-reta" class="quarto-xref">Figura&nbsp;1</a> (b), regressão busca traçar uma reta que cruze as observações dos pares ordenados <span class="math inline">\((x,y)\)</span> com o melhor ajuste, isto é, com a menor distância entre os pontos e <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> são, respectivamente os coeficientes lineares e de inclinação dessa reta.</p>
<div id="fig-reta" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-reta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1: A reta de regressão
</figcaption>
<div aria-describedby="fig-reta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-reta" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-reta-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-reta-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-reta-1.png" class="img-fluid figure-img" data-ref-parent="fig-reta" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-reta-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Dados
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-reta" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-reta-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-reta-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-reta-2.png" class="img-fluid figure-img" data-ref-parent="fig-reta" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-reta-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Reta e parâmetros
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>Quando há somente uma variável explicativa, <em>k=1</em>, chama-se <strong>modelo de regressao simples</strong>.</p>
<p><span class="math display">\[y=\beta_0+\beta_1 X+ \epsilon\]</span></p>
<p><strong>y</strong> é o valor da observado da variável dependente, <span class="math inline">\(\beta_0\)</span> é intercepto ou coeficente linear, e <span class="math inline">\(\beta_i\)</span> coeficiente de inclinação, <span class="math inline">\(\varepsilon_i\)</span> é u termo aleatório normalmente distribuído com média zero e variância constante.</p>
<p>Quando há mais de uma varável explicativa, <em>k&gt;</em>1, chama-se <strong>modelo de regressão múltipla</strong>.</p>
<p><span class="math display">\[E(y|x) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_k X_k+ \epsilon\]</span></p>
<p><span class="math inline">\(X_k\)</span> são as variáveis independentes, <span class="math inline">\(\beta_0\)</span> é uma constante que representa o coeficiente linear ou intercepto do modelo, <span class="math inline">\(\beta_1,\dots,\beta_k\)</span> são os parâmetros de declividade ou coeficientes angulares associados às variáveis independentes.</p>
<p>Os valores dos parâmetros <span class="math inline">\(\beta\)</span> são desconhecidos, mas podem ser estimados a partir de dados amostrais, observados ou experimentais, de forma que os modelo estimado é o seguinte:</p>
<p><span class="math display">\[y_i = b_0 + b_1 X_1 + b_2 X_2 + \dots + b_k X_k+e_i\:,\:\: i=1,\dots,N\]</span></p>
<p><span class="math inline">\(y_i\)</span> é o valor da observado da variável dependente, <em>i</em> é o número da observação, <em>N</em> é o total de observações da amostra, <span class="math inline">\(X_k\)</span> são as variáveis independentes, <span class="math inline">\(b_0\)</span> é a estimativa do intercepto do modelo, <span class="math inline">\(b_1,\dots,b_k\)</span> são as estimativas dos coeficientes angulares, <span class="math inline">\(e_i\)</span> é o valor do termo aleatório ou resíduo.</p>
</section>
<section id="predição-de-valores" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="predição-de-valores"><span class="header-section-number">3.2</span> Predição de valores</h2>
<p>Uma vez de posse da estimativa de <span class="math inline">\(\beta\)</span>, o modelo permite predizer ou ajustar os valores da variável dependente contidos no vetor <span class="math inline">\(\hat{y}\)</span>, para os valores de <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[ \hat{y}_i=b_0 + b_1 X_i\]</span></p>
</section>
<section id="os-resíduos" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="os-resíduos"><span class="header-section-number">3.3</span> Os resíduos</h2>
<p>O método dos MQO envolve encontrar <span class="math inline">\(\mathbf{b}\)</span> que minimize a soma dos quadrados dos resíduos. O resíduo (<span class="math inline">\(e_i\)</span>) pode ser definido como a diferença entre o valor observado (<span class="math inline">\(y_i\)</span>) é aquele calculado pelo modelo, denominado valor ajustado ou previsto (<span class="math inline">\(\hat{y}\)</span>), podendo se expresso como abaixo</p>
<p><span class="math display">\[e_i =y_i-\hat{y}_i\]</span></p>
<p>Os resíduos são ilustrados na <a href="#fig-residuos" class="quarto-xref">Figura&nbsp;2</a> e são estimativas dos valores do termo aleatório <span class="math inline">\(\epsilon\)</span> os quais não são observáveis.</p>
<div class="cell fig-cap-location-top" data-cap-location="top">
<div class="cell-output-display">
<div id="fig-residuos" class="quarto-figure quarto-figure-center quarto-float anchored" data-cap-location="top">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-residuos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2: Os resíduos
</figcaption>
<div aria-describedby="fig-residuos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-residuos-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="teste-dos-parâmetros" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="teste-dos-parâmetros"><span class="header-section-number">3.4</span> Teste dos parâmetros</h2>
<p>Dois testes de hipóteses sobre os parâmatros do modelo podem ser realizados a partir de suas estimativas. Pode-se testar o intercepto é zero, conforme a formulação a seguir:</p>
<ul>
<li><span class="math inline">\(H_0: \beta_0=0\)</span></li>
<li><span class="math inline">\(H_1: \beta_0\neq0\)</span></li>
</ul>
<p>Pode-se avaliar se cada uma das variáveis independentes (<span class="math inline">\(X_k\)</span>) são capazes de influenciar a variável dependente (<span class="math inline">\(y\)</span>) Se não forem capazes o valor do seu respectivo coeficiente de inclinação será zero, conforme a formulação a seguir:</p>
<ul>
<li><span class="math inline">\(H_0: \beta_k=0\)</span></li>
<li><span class="math inline">\(H_1: \beta_k\neq0\)</span></li>
</ul>
<p>As decisões dos testes de hipóteses acima são baseadas no teste t, conforme o nível de significãncia adotado (geralmente <span class="math inline">\(\alpha=0,05\)</span>) nos valores P associados a essa estatística. <strong>Rejeita-se a hipótese nula, caso o valor P seja inferior a 0,05.</strong></p>
</section>
</section>
<section id="regressão-no-r" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Regressão no R</h1>
<section id="o-que-é-o-r" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="o-que-é-o-r"><span class="header-section-number">4.1</span> O que é o R?</h2>
<p>O R é um ambiente computacional aberto, destinado á análise de dados, disponível gratuitamente na internet e que possui uma ampla comunidade de colaboração volutária. Aliado ao ambiente de desenvolvimento integrado(IDE) RStudio, também disponível gratuitamente, oferece uma interface amigável e integração com outros programas,como o Quarto, o que possibilita a geração de relatórios instantâneos em HyperText Markup Language (HTML), Portable Document Format (PDF) e Microsoft Word.</p>
<p>O programas podem ser baixados para instalaçao nos seguintes endereços.</p>
<ul>
<li><a href="https://cran.r-project.org/bin/windows/base/" class="external" target="_blank">R</a></li>
<li><a href="https://posit.co/download/rstudio-desktop/" class="external" target="_blank">RStudio</a></li>
</ul>
<p>Importante, destacar que o R é o software que realizada os cálculos e gráficos e o RStudio é uma interface, portanto esta não irá funcionar sem o R estar instalado.</p>
<p>Ao ser instalado o R traz um conjunto de pacotes básicos. Um pacote é um conjunto de funções que permitem realizar as operações necessárias. Todavia, um conjunto de pacotes adicionais para inúmeros propósitos que podem ser instalados.</p>
<p>A instalação de um pacote pode ser realizada por meio da função <code>install.packages()</code> com o nome do pacote desejado. Por exemplo, vamos instalar o pacote <strong>readxl</strong> que é útil para importar e exportar dados para Excel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"readxl"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Após instalado, para que os seus recursos sejam ativados, é necessário carregá-lo com a função <code>library()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Os recursos desse pacote adicional agora estão disponíveis para as atividades de análise.</p>
<p>Durante este minicurso são utilizados os seguintes pacotes adicionais:</p>
<ul>
<li>readxl <span class="citation" data-cites="readxl">(<a href="#ref-readxl" role="doc-biblioref">Wickham e Bryan, 2023</a>)</span></li>
<li>lmtest <span class="citation" data-cites="lmtest">(<a href="#ref-lmtest" role="doc-biblioref">Zeileis e Hothorn, 2002</a>)</span></li>
<li>car <span class="citation" data-cites="car">(<a href="#ref-car" role="doc-biblioref">Fox e Weisberg, 2019</a>)</span></li>
</ul>
</section>
<section id="o-diretório-de-trabalho" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="o-diretório-de-trabalho"><span class="header-section-number">4.2</span> O diretório de trabalho</h2>
<p>O <em>Working directory</em> ou diretório de trabalho, em português, é a pasta em que o R está salvando e lendo objetos. Logo é nesse diretório em que devem estar salvos os arquivos do seu projeto de análise.</p>
<p>A função <code>getwd()</code> exibe o diretório de trabalho atual.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>() <span class="co"># diretorio atual</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para alterar o diretório, utilise a função <code>setwd()</code>, informando o caminho. No caminho. Certifique-se de não utilizar, no caminho, o padrão do windows que é ““, pois no R, o caminho é informado, usando”\” ou “/” .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"meu</span><span class="sc">\\</span><span class="st">caminho"</span>) <span class="co"># conf. diretório</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"meu/caminho"</span>)  <span class="co"># conf. diretório</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Uma alternativa mais confortável para configurar o diretório, é o uso do <strong>Menu</strong>: <em>Session/Setting Working Directory/Choose Directory</em>.</p>
</section>
<section id="lendo-e-examinando-dados-no-r" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="lendo-e-examinando-dados-no-r"><span class="header-section-number">4.3</span> Lendo e examinando dados no R</h2>
<p>Vamos modelar os efeitos da proporção de substituição (<strong>ps</strong>) de agregados por resíduos de algum material sobre a resistência à compressão axial (<strong>rca</strong>) de um determinado compósito cimentício. Os dados estão na primeira aba, <strong>ex1_compressao</strong>, do arquivo do excel <a href="dadosConnepi.xlsx"><strong>dadosConnepi.xlsx</strong></a> que deve está salvo no diretrório de trabalho. Para importar os dados, usa-se a função <code>read_excel()</code> do pacote <strong>readxl</strong> que já deve instalado no R porque não é um pacote básico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"readxl"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Carrega-se o pacote e os dados podem ser importados com a função <code>read_excel()</code> e salvos no objeto <code>dados</code>.</p>
<p>Os valores do objeto <code>dados</code> podem ser exibidos no console pelo seu nome. As colunas podem ser acessadas, com o uso dos cifrões. A estrutura dos dados pode ser exibida com a função <code>str()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"dadosConnepi.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"ex1_compressao"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>dados</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
      ps   rca
   &lt;dbl&gt; &lt;dbl&gt;
 1     0  9.44
 2     0  9.77
 3     0 11.6 
 4     0 10.1 
 5     0 10.1 
 6    10  8.72
 7    10  7.46
 8    10  5.73
 9    10  6.31
10    10  6.55
11    20  5.22
12    20  4.36
13    20  4.4 
14    20  4.11
15    20  3.44</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>ps</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0  0  0  0  0 10 10 10 10 10 20 20 20 20 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [15 × 2] (S3: tbl_df/tbl/data.frame)
 $ ps : num [1:15] 0 0 0 0 0 10 10 10 10 10 ...
 $ rca: num [1:15] 9.44 9.77 11.56 10.07 10.13 ...</code></pre>
</div>
</div>
<p>Um gráfico pode ser produzido com o comando <code>plot()</code>. Os argumentos podem ser informados de duas maneiras. A primeira inserido os valores das colunas individualmente, eixo horizontal e vertical. A segunda na forma de fórmula e indicando o objeto com os dados, nesse caso não precisa usar os cifrões.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dados<span class="sc">$</span>ps,dados<span class="sc">$</span>rca,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Proporção de resíduos (%)"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Resistência (MPa)"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rca<span class="sc">~</span>ps, <span class="at">data =</span> dados,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Proporção de resíduos (%)"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Resistência (MPa)"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O ajuste ou estimação do modelo de regressão linear no R é realizado pela função <code>lm()</code>. Os argumentos devem ser inseridos na forma de fórmula. Os argumento <code>(rca ~ ps, data = dados)</code>, informam que se deve estimar o modelo de <em>rca</em> “em função” de <em>ps</em> e que os valores estão armazanados no objeto <code>dados</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(rca <span class="sc">~</span> ps, <span class="at">data =</span> dados)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rca ~ ps, data = dados)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.42133 -0.62833 -0.02533  0.25067  1.56867 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 10.09533    0.35828   28.18 4.85e-13 ***
ps          -0.29440    0.02775  -10.61 9.03e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8776 on 13 degrees of freedom
Multiple R-squared:  0.8964,    Adjusted R-squared:  0.8885 
F-statistic: 112.5 on 1 and 13 DF,  p-value: 9.031e-08</code></pre>
</div>
</div>
</section>
<section id="predizendo-valores-no-r" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="predizendo-valores-no-r"><span class="header-section-number">4.4</span> Predizendo valores no R</h2>
<p>Os valores ajustados para o valores das variáveis independentes pode ser para os valores <span class="math inline">\(X\)</span> da amostra e para outros valores. O valores ajustados da amostra já estão armazenados no objeto <code>mod</code>, sendo acessado com o cifrão:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>fitted.values</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
10.095333 10.095333 10.095333 10.095333 10.095333  7.151333  7.151333  7.151333 
        9        10        11        12        13        14        15 
 7.151333  7.151333  4.207333  4.207333  4.207333  4.207333  4.207333 </code></pre>
</div>
</div>
<p>Para outros valores de X, pode-se utilizar a função <code>predict()</code> que utiliza o modelo armazenado no objeto, <code>mod</code> neste exemplo, e o novos valores num objeto do tipo data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defina os novos valores</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dadosnovos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ps=</span><span class="dv">15</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use o modelo para predições</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, dadosnovos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
5.679333 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dadosnovos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ps=</span><span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, dadosnovos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3 
5.679333 5.384933 5.090533 </code></pre>
</div>
</div>
</section>
</section>
<section id="qualidade-do-ajuste" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Qualidade do ajuste</h1>
<p>A qualidade do ajuste modelo é a avaliação da capacidade do modelo de regressão explicar as variações de valores da variável dependente, de fazer predições e quais variáveis ajudam nessa explicação. A seguir são descritas brevemente as medidas que permitem essas avaliações.</p>
<p>A estatística <strong>F Anova</strong> (<em>F-statistic</em>) mede o efeito conjunto das variáveis independentes (fatores) sobre a variável dependente (resposta). Testa a hipótese nula de que nenhuma das variáveis independentes é capaz de descrever o comportamento da variável dependente. Para que o modelo de regressão proposto seja significativo, a hipótese nula deve ser rejeitada, em geral, quando <span class="math inline">\(\text{Valor P} &lt; \alpha = 0, 05\)</span>.</p>
<p>O <strong>Coeficiente de determinação</strong> (<em>Multiple R-squared</em> - <span class="math inline">\(R^2\)</span>) mede a proporção da variação explicada pela regressão e seu valor varia de 0 a 1, quanto maior esse valor, maior poder explicativo do modelo.</p>
<p>No caso de regressão múltipla, o <strong>Coeficiente de determinação ajustado</strong> (<em>Adjusted R-squared</em>) mede a proporção da variação explicada pela regressão, mas penaliza o número de variáveis independentes, uma vez que modelos parcimoniosos são preferíveis por sua simplicidade, logo, o acréscimo de uma variável e da complexidade devem ser justificados por um aumento razoável no poder explicativo.</p>
<p>O <strong>Erro Padrão Residual</strong> , ou <em>Residual Standard Error</em>, também denominado Raiz do Erro Quadrático médio, ou <em>Root Mean Squared Error (RMSE)</em>, mede o grau de dispersão em torno da linha de regressão e quanto menor o seu valor, melhor. No R, é calculado pela seguite Equação:</p>
<p><span class="math display">\[
RMSE = \sqrt{\frac{\sum_{i=1}^n (y_i-\hat{y}_i)^2}{n-k}}
\]</span></p>
<p>onde RMSE é expressa na mesma unidade de y, <em>n</em> é o número de observações e <em>k</em>, o número de parâmetros a serem estimados, o demoninador indica o número de graus de liberdade. Importante ressaltar que, no cálculo do RSME, geralmente se dividem os desvios ao quadro por <em>n</em>, mas a divisão por <span class="math inline">\((n-k)\)</span> permite a obtenção de um valor não viesado erro padrão do erro.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rca ~ ps, data = dados)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.42133 -0.62833 -0.02533  0.25067  1.56867 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 10.09533    0.35828   28.18 4.85e-13 ***
ps          -0.29440    0.02775  -10.61 9.03e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8776 on 13 degrees of freedom
Multiple R-squared:  0.8964,    Adjusted R-squared:  0.8885 
F-statistic: 112.5 on 1 and 13 DF,  p-value: 9.031e-08</code></pre>
</div>
</div>
</section>
<section id="pressupostos-do-modelo-de-regressão" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Pressupostos do Modelo de Regressão</h1>
<section id="os-pressupostos" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="os-pressupostos"><span class="header-section-number">6.1</span> Os pressupostos</h2>
<ol type="1">
<li><p><strong>Linearidade</strong> A relação entre as variáveis explicativas e a variável dependente é linear. A linearidade pode ser avaliada através da inspeção dos gráficos de dispersão ou de resíduos.</p></li>
<li><p><strong>Homocedasticidade</strong>: A variância dos resíduos é constante para todos os valores de <em>X</em>. A dispersão dos resíduos deve se manter ao longo dos valores das variáveis independentes, como exibido na <a href="#fig-homohetero" class="quarto-xref">Figura&nbsp;3</a> (a). Quando a dispersão, por exemplo, aumenta com os valores de X, como na <a href="#fig-homohetero" class="quarto-xref">Figura&nbsp;3</a> (b) e ou se altera com algum padrão, como na <a href="#fig-homohetero" class="quarto-xref">Figura&nbsp;3</a> (c), diz-se que o modelo apresenta heterocedasticidade, ou seja, a variância dos resíduos não é constante.</p></li>
</ol>
<p><span class="math display">\[var(\varepsilon|X_1, X_2, \dots, X_k) = \sigma^2\]</span></p>
<div class="cell fig-cap-location-top" data-cap-location="top">
<div class="cell-output-display">
<div id="fig-homohetero" class="quarto-figure quarto-figure-center quarto-float anchored" data-cap-location="top">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-homohetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3: Homocedasticidade e heterocedasticidade
</figcaption>
<div aria-describedby="fig-homohetero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/heterocedasticidade.png" class="img-fluid figure-img">
</div>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li><strong>Independência dos erros</strong>: os valores de um erro (i) não influencia o valor de outro (j), expressa pelo valor nulo de qualquer par de covariância de erros aleatórios.</li>
</ol>
<p><span class="math display">\[cov(\varepsilon_i,\varepsilon_j)=0 \; (i \neq j)\]</span></p>
<p>Isso implica que os valores de y também são estatisticamente independentes e visse-versa.</p>
<p><span class="math display">\[cov(\varepsilon_i,\varepsilon_j)=cov(y_i,y_j)=0 \; (i \neq j)\]</span></p>
<ol start="4" type="1">
<li>Os erros seguem distribuição normal com média zero e variância constante.</li>
</ol>
<p><span class="math display">\[\varepsilon_i \sim N(0, \sigma^2)\]</span></p>
<p><span class="math display">\[E(\varepsilon|X)=0\]</span></p>
<p>que implica em afirmar que</p>
<p><span class="math display">\[E(y|X)=\beta_0+\beta_1X_1+\dots+\beta_kX_k\]</span></p>
<ol start="5" type="1">
<li><strong>Não multicolinearidade perfeita</strong>: as variáveis explicativas são linearmente independentes, isto é, não há correlação perfeita entre elas. A correlação elevada entre as variáveis independentes dificulta a determinação do efeito exato de cada uma sobre a variável dependente.</li>
</ol>
<table class="caption-top table">
<caption>Pressuspostos e técnicas de exame</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Pressuposto</th>
<th>Exame</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linearidade</td>
<td>Gráfico de dispersão dos resíduos em função dos valores ajustados</td>
</tr>
<tr class="even">
<td>Homocedasticidade</td>
<td>Gráfico de dispersão dos resíduos em função dos valores ajustados, gráfico (Scale-Location), Teste de Breusch-Pagan</td>
</tr>
<tr class="odd">
<td>Normalidade zero dos resíduos</td>
<td>Gráfico de dispersão dos resíduos em função dos valores ajustados</td>
</tr>
<tr class="even">
<td>Normalidade</td>
<td>QQ-plot e teste de Shapiro-Wilk</td>
</tr>
<tr class="odd">
<td>Independência dos resíduos</td>
<td>Gráfico dos resíduos e Coeficiente de Autocorrelação</td>
</tr>
<tr class="even">
<td>Multicolinearidade</td>
<td>Fator de inflação de variância (VIF) e Tolerância</td>
</tr>
</tbody>
</table>
</section>
<section id="avaliação-dos-pressupostos" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="avaliação-dos-pressupostos"><span class="header-section-number">6.2</span> Avaliação dos pressupostos</h2>
<p>A avaliação dos pressupostos da regressão, na maior parte, é realizada por meio de exames dos resíduos na forma de gráficos e de testes estatísticos. No R, alguns exames podem ser aplicados diretamente ao objeto em que o modelo foi salvo, mas outros exigem que os valores dos resíduos sejam extraídos.</p>
<p>Os valores do modelo salvo em <code>mod</code> podem ser acessado com o uso do cifrão. Digite o nome do objeto acrescente o cifrão que uma lista de valores será apresentada. Nos comandos a seguir são extraídos os valores dos resíduos e os valores ajustados do modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>residuals</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5           6 
-0.65533333 -0.32533333  1.46466667 -0.02533333  0.03466667  1.56866667 
          7           8           9          10          11          12 
 0.30866667 -1.42133333 -0.84133333 -0.60133333  1.01266667  0.15266667 
         13          14          15 
 0.19266667 -0.09733333 -0.76733333 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>fitted.values</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
10.095333 10.095333 10.095333 10.095333 10.095333  7.151333  7.151333  7.151333 
        9        10        11        12        13        14        15 
 7.151333  7.151333  4.207333  4.207333  4.207333  4.207333  4.207333 </code></pre>
</div>
</div>
<p>A <a href="#fig-resfit" class="quarto-xref">Figura&nbsp;4</a> é um gráfico de dispersão de resíduos em função dos valores ajustados e permite o exame visual da <strong>linearidade</strong> do modelo da <strong>homocedasticidade</strong>. A linha horizontal foi traçada na altura da média dos resíduos.</p>
<div class="cell fig-cap-location-top">
<div class="sourceCode cell-code" id="cb28" data-cap-location="top"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod<span class="sc">$</span>fitted.values, mod<span class="sc">$</span>residuals)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(mod<span class="sc">$</span>residuals), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-resfit" class="quarto-figure quarto-figure-center quarto-float anchored" data-cap-location="top">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-resfit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;4: Resíduos em função dos valores ajustados
</figcaption>
<div aria-describedby="fig-resfit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-resfit-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>A <strong>normalidade</strong> pode ser examinda por meio do gráfico quantil-quantil (<em>Normal qqplot</em>) e de um teste de aderência, aqui utilizaremos o teste de Shapiro-Wilk <span class="citation" data-cites="shapiro1965analysis">(<a href="#ref-shapiro1965analysis" role="doc-biblioref">Shapiro e Wilk, 1965</a>)</span>.</p>
<p>O <em>Normal Q-Q plot</em> é utilizado para exame visual da normalidade das observações, podendo ser elaborado com as funções <code>qqnorm()</code> e <code>qqline()</code>, tendo como principal argumento os resíduos do modelo. Caso os dados sejam normalmente distribuídos os pontos devem se situar aleatoriamente próximos à reta.</p>
<p>O Normal Q-Q plot, na fig-qqplot, mostra que a maior parte dos resíduos está próximo da, no entanto, três valores se afastam mais, exigindo um exame formal para verificar se esse afastamento é grave.</p>
<div class="cell fig-cap-location-top">
<div class="sourceCode cell-code" id="cb29" data-cap-location="top"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(mod<span class="sc">$</span>residuals, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(mod<span class="sc">$</span>residuals)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-qqplot" class="quarto-figure quarto-figure-center quarto-float anchored" data-cap-location="top">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-qqplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5: QQ plot dos resíduos
</figcaption>
<div aria-describedby="fig-qqplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-qqplot-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>Uma alternativa gráfica interessane é o QQ-plot gerado pelo comando <code>qqPlot()</code> do pacote <strong>car</strong>, o qual deve ter sido previamente instalado com o comando e carregado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"car"</span>) <span class="co"># instala</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># carrega</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nessa alternativa, um intervalo de confiança é traçada em torno da reta para demarcar o limite de devios toleráveis, assim, as observações de dados normalmente distribuídos devem se mater dentro do intervalo.</p>
<p>Apesar da maioria dos dados se manterem dentro dos intervao de confiança, as observações 3 e 6 ultrapassaram os limites. Seria interessante a realização de um teste formal.</p>
<div class="cell fig-cap-location-top">
<div class="sourceCode cell-code" id="cb32" data-cap-location="top"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(mod<span class="sc">$</span>res, <span class="at">ylab =</span> <span class="st">"Resíduos"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-cap-location="top"><code>[1] 6 3</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-qqplot2" class="quarto-figure quarto-figure-center quarto-float anchored" data-cap-location="top">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-qqplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6: QQ plot dos resíduos com intervalo de confiança.
</figcaption>
<div aria-describedby="fig-qqplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-qqplot2-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>O teste de Shapiro-Wilk <span class="citation" data-cites="shapiro1965analysis">(<a href="#ref-shapiro1965analysis" role="doc-biblioref">Shapiro e Wilk, 1965</a>)</span> é um teste formal de distribuição de normalidade que testa as seguites hipóteses:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: Os dados seguem distribuição normal.</li>
<li><span class="math inline">\(H_1\)</span>: Os dados NÃO seguem distribuição normal.</li>
</ul>
<p>Considerando um nível de significância de 0,05, rejeita-se a hipótese nula se <span class="math inline">\(p&lt;0,05\)</span>, caso contrário aceita-se a afirmação de normalidade. Então o que se espera é que <span class="math inline">\(p&gt;0,05\)</span>, indicando normalidade e continuidade da análise sem a violação desse pressuposto.</p>
<p>A função <code>shapiro.test()</code> exibe os valores da estatística de teste (<em>W</em>), que é uma qui-quadrado, e o <em>valor P</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mod<span class="sc">$</span>residuals)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  mod$residuals
W = 0.94907, p-value = 0.51</code></pre>
</div>
</div>
<p>A análise da <strong>homecedasticidade</strong> pode ser realizado por inspeção visual do gráfico de dispersão dos resíduos em função dos valores ajustados, na <a href="#fig-resfit" class="quarto-xref">Figura&nbsp;4</a>, pelo gráfico Scale-Location (a ser apresentado adiante) e com o teste de Breusch-Pagan <span class="citation" data-cites="breusch1979simple">(<a href="#ref-breusch1979simple" role="doc-biblioref">Breusch e Pagan, 1979</a>)</span>.</p>
<p>O teste de Breusch-Pagan <span class="citation" data-cites="breusch1979simple">(<a href="#ref-breusch1979simple" role="doc-biblioref">Breusch e Pagan, 1979</a>)</span> avalia as seguites hipóteses:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: Variância é constante.</li>
<li><span class="math inline">\(H_1\)</span>: Variância NÃO é constante.</li>
</ul>
<p>Considerando um nível de significância de 0,05, rejeita-se a hipótese nula se <span class="math inline">\(p&lt;0,05\)</span>, indicando a presença de heterocedasticidade, caso contrário, aceita-se a afirmação de homocedasticidade.</p>
<p>A função <code>bptest()</code> do pacote <strong>lmtest</strong> efetua o teste de Breusch-Pagan, mas antes o pacote precisa ser instalado por meio da função <code>install.packages()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"lmtest"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No resultado do função, BP corresponde à estística de teste e o seu correspondente valor P = 0.7031, por ser superior 0,05, é não é significante, de forma que não se pode rejeitar a hipótese nula e indica homocedasticidade.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(mod)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  mod
BP = 0.14522, df = 1, p-value = 0.7031</code></pre>
</div>
</div>
<p>Um resurso muito ágil e amplo de avaliar os presssupostos do modelo são os <em>gráficos de diagnóstico do modelo</em> acionados pela conjugação da função <code>plot()</code> e o objeto com as dados do modelo <span class="citation" data-cites="correa2021superficie">(<a href="#ref-correa2021superficie" role="doc-biblioref">Corrêa <em>et al.</em>, 2021</a>)</span></p>
<p>Trata-se de 4 gráficos que são acionados e apresentados a medida que pressiona ENTER no console.</p>
<ol type="a">
<li>Resíduos vs valores ajustados;</li>
<li>QQplot dos resíduos;</li>
<li>Scale-location;</li>
<li>Resíduos vs alavangem (<em>Residuals vs Leverage</em>)</li>
</ol>
<p>Todavia, é mais confortável, dividir-se a janela gráfica e quatro partes e se apresentar todos juntos para um exame mais rápido. A divisão da janela em 2 linhas e 2 colunas é relizada com o comando <code>par(mfrow = c(2,2))</code>. Em seguida, digita-se o comando para geração dos 4 gráficos de diagnósticos do modelo, conforme apresentados na <a href="#fig-diagnosticos" class="quarto-xref">Figura&nbsp;7</a>.</p>
<div class="cell fig-cap-location-top">
<div class="sourceCode cell-code" id="cb39" data-cap-location="top"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diagnosticos" class="quarto-figure quarto-figure-center quarto-float anchored" data-cap-location="top">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-diagnosticos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7: Gráficos de diagnóstico do modelo
</figcaption>
<div aria-describedby="fig-diagnosticos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-diagnosticos-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>O primeiro é o gráfico de <strong>resíduos vs valores ajustados</strong>, já elaborado anteriomente na <a href="#fig-resfit" class="quarto-xref">Figura&nbsp;4</a>, sendo útil para o exame da linearidade e da homocedasticidade, mas com o acréscimo de uma linha central para facilitar a análise da dispersão das observações. No caso de linearidade, a linha vermelha será razoavelmente horizontal, mas caso reste algum padrão não linear nos resíduos, a linha vermelha refletirá tal padrão.</p>
<p>O gráfico não revela padrões restantes nos resíduos e a linha vermelha, apesar do leve vale em X=7, é razoavelmente horizontal, de forma que não há indícios de violação da linearidade. O três números destacados (3, 6 e 8) indicam três maiores resíduos, mas não são necessariamente atípicos (<em>outliers</em>).</p>
<p>O segundo gráfico é o <strong>QQplot</strong> permite o exame de normalidade e já foi elaborado na <a href="#fig-qqplot" class="quarto-xref">Figura&nbsp;5</a>, chamando atenção para três valores que se afastam da reta.</p>
<p>O terceiro gráfico é o <strong>scale-location</strong> que é a dispersão dos raízes dos resíduos padronizados em função dos valores ajustados sendo útil para o exame da homocedasticidade. Em caso de homocedasticidade, a linha vermelha será razoavelmente horizontal e os pontos devem se dispersar de forma similar ao longo dos valores ajustados.</p>
<p>O gráfico revela alguma suspeita de dispersão ligeiramente maior no valor 10, mas a linha vermelha não exibe tendência, portanto, é apesar não não haver indícios de dispersão heterôgenea grave dos resíduos, é prudente incluir um teste formal na análise, o qual já foi realizado pelo teste de Breusch-Pagan anteriormente.</p>
<p>O quarto é o gráfico de <strong>Resíduos vs alavangem</strong> (<em>Residuals vs Leverage</em>) destinado à identificação de valores atípicos (<em>outliers</em>). Os valores limites para que determinadas observações devam ser avaliadas como possível outlier são as distâncias de Cook que mensuram a influência que as observaçoes exercem sobre a estimativa do modelo. Os valores de corte são apresentadas como linhas tracejadas no interior do gráfico e a intepretação dos seus valores podem são apresentadas na Tabela abaixo.</p>
<table class="caption-top table">
<caption>Interpretação da distância de Cook</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>D</th>
<th>Interpretação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(D&lt;0,5\)</span></td>
<td>Não são é uma observação atípica</td>
</tr>
<tr class="even">
<td><span class="math inline">\(0,5&lt; D \leq 1\)</span></td>
<td>Geralmente útil estudar a influência de tais observações</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(D&gt;1\)</span></td>
<td>Deve-se avaliar a sua exclusão da amostra.</td>
</tr>
</tbody>
</table>
<p>O Residuals vs Leverage na <a href="#fig-diagnosticos" class="quarto-xref">Figura&nbsp;7</a> não exibe observações ultrapassando alguma linha de corte da distância de Cook, aliás apenas parte uma linha de D=0,5 aparace no canto superior direito do gráfico, de modo que não há indícios de valores atípicos na amostra.</p>
<p>Um gráfico com os valores individuais da distância de Cook podem ser exibidos num único gráfico. Para retornar para uma janela sem divisão basta digitar <code>par(mfrow = c(1,1))</code> e o próximo gráfico será gerado em janela única.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No comando de gráficos de diagnósticos, identifique que deve ser exibido somente o quarto gráfico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="o-modelo-final" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> O modelo final</h1>
<p>Após constatação de que os pressupostos do da regressão linear não foram violados, o modelo que descreve os efeitos da proporção de substituição (<strong>ps</strong>) de agregados por resíduos de algum material sobre a resistência à compressão axial (<strong>rca</strong>) de um compósito cimentício é o seguinte:</p>
<p><span class="math display">\[
\hat{y_i}= 10,0953 - 0,29440 X_i
\]</span></p>
<p>Condiderando que se trata de uma regressão simples, pode-se elaborar um gráfico para publicação com os seguinte código:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rca <span class="sc">~</span> ps, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">data=</span>dados, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Proporção de resíduos (%)"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Resistência à Compressão"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="praticando" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Praticando</h1>
<p>Suponha que desejamos estimar os custos indiretos fabrição de uma fábrica de doces. Os dados mensais dos custos indiretos de fabricação, custos de embalagens, produção em toneladas e despesas de divulgação estão na aba <strong>ex2_fabrica</strong> do arquivo do excel <a href="dadosConnepi.xlsx"><strong>dadosConnepi.xlsx</strong></a> e cujas seis primeiras linhas são exibidas na <a href="#tbl-fabrica" class="quarto-xref">Tabela&nbsp;1</a>.</p>
<div class="cell" data-tbl-cap-location="top">
<div id="tbl-fabrica" class="cell quarto-float anchored" data-tbl-cap-location="top">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fabrica-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;1: Primeiras seis observaçoes dos dados de custos mensais de uma fábrica de doces
</figcaption>
<div aria-describedby="tbl-fabrica-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">data</th>
<th style="text-align: right;">ci</th>
<th style="text-align: right;">embalagem</th>
<th style="text-align: right;">toneladas</th>
<th style="text-align: right;">divulgacao</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2015-01-01</td>
<td style="text-align: right;">218501.0</td>
<td style="text-align: right;">2790.90</td>
<td style="text-align: right;">42.3</td>
<td style="text-align: right;">253.81</td>
</tr>
<tr class="even">
<td style="text-align: left;">2015-02-01</td>
<td style="text-align: right;">209982.3</td>
<td style="text-align: right;">2866.50</td>
<td style="text-align: right;">29.7</td>
<td style="text-align: right;">877.03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2015-03-01</td>
<td style="text-align: right;">228401.9</td>
<td style="text-align: right;">2573.55</td>
<td style="text-align: right;">53.1</td>
<td style="text-align: right;">575.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">2015-04-01</td>
<td style="text-align: right;">176657.2</td>
<td style="text-align: right;">1584.45</td>
<td style="text-align: right;">54.0</td>
<td style="text-align: right;">909.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2015-05-01</td>
<td style="text-align: right;">207152.2</td>
<td style="text-align: right;">2178.75</td>
<td style="text-align: right;">53.1</td>
<td style="text-align: right;">1178.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">2015-06-01</td>
<td style="text-align: right;">249873.8</td>
<td style="text-align: right;">3082.80</td>
<td style="text-align: right;">55.8</td>
<td style="text-align: right;">1025.11</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Com base nas informaçoes forncecidas, faça o que se pede:</p>
<ol type="a">
<li>Importe dos dados</li>
<li>Ajuste o modelo de regressão linear dos ci em função da embalagem, toneladas e divulgação.</li>
<li>Avalie o ajuste do modelo</li>
<li>Examine os pressupostos de linearidade , homocedasticidade e normalidade e examine a presença de valores atípicos avalia a significância do efeito das variáveis independentes.</li>
<li>Decida qual o modelo descritivo.</li>
</ol>
<p><strong>SCRIPT DE RESOLUÇÃO SUGERIDO</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fabrica <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"dadosConnepi.xlsx"</span>, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">"ex2_fabrica"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ci <span class="sc">~</span> embalagem <span class="sc">+</span> toneladas <span class="sc">+</span> divulgacao, <span class="at">data =</span> fabrica)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>) <span class="co"># Desativa notação cient.</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mod<span class="sc">$</span>residuals)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest) <span class="co"># carrega pacote</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(mod)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ci <span class="sc">~</span> embalagem <span class="sc">+</span> toneladas, <span class="at">data =</span> fabrica)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod3)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multicolinearidade" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Multicolinearidade</h1>
<p>Ocorre multicolinearidade num modelo de regressão quando duas ou mais variáveis independentes são altamente correlacionadas de modo que não proporcionam informação individualizada e independente e, consequentemente, os valores das estimativas e de seus respecitivos valores P deixam de ser confiáveis.</p>
<p>O Fator de Inflação da Variância (VIF) é uma medida de multicolinearidade frequentemente utilizada e pode ser calculada para cada uma das variáveis independentes (<span class="math inline">\(X_j\)</span>).</p>
<p><span class="math display">\[
VIF = \frac{1}{1-R_j^2}, \quad j=1,\dots,k
\]</span></p>
<p>onde <span class="math inline">\(R_j^2\)</span> é o coeficiente de regressão de uma regresssão de <span class="math inline">\(X_j\)</span> como variável dependente em função das demais do modelo e <span class="math inline">\(k\)</span> é o número de variáveis indenpendentes.</p>
<p>O valor de VIF de uma variável pode ser intepretado da seguite maneira:</p>
<ul>
<li>VIF = 1: Ausência de correlação</li>
<li>VIF &gt; 5 ou 10: Multicolinearidade severa.</li>
</ul>
<p>Alguns autores adotam com regra para multicolinearidade severa quando VIF &gt; 5 <span class="citation" data-cites="sheather2009modern">(<a href="#ref-sheather2009modern" role="doc-biblioref">Sheather, 2009</a>)</span>, outros quando VIF&gt;10 <span class="citation" data-cites="gujarati2004basic chatterjee2015regression">(<a href="#ref-chatterjee2015regression" role="doc-biblioref">Chatterjee e Hadi, 2015</a>; <a href="#ref-gujarati2004basic" role="doc-biblioref">Gujarati, 2004</a>)</span>.</p>
<p>No R, o VIF pode ser calculado com a função <code>vif()</code> do pacote <strong>car</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ci <span class="sc">~</span> embalagem <span class="sc">+</span> toneladas, <span class="at">data =</span> fabrica)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>embalagem toneladas 
 1.000879  1.000879 </code></pre>
</div>
</div>
</section>
<section id="trabalhos-com-regressão" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Trabalhos com regressão</h1>
<p>Aqui alguns trabalhos que utilizam regressão e R realizados pelo Grupo de Estudos Avançados em Gestão:</p>
<p><a href="https://www.researchgate.net/publication/347269763_Politicas_e_praticas_de_gestao_de_pessoas_e_intencao_de_rotatividade_um_estudo_no_Instituto_Federal_do_Para_Brasil" class="external" target="_blank">Políticas e práticas de gestão de pessoas e intenção de rotatividade: um estudo no Instituto Federal do Pará (Brasil)</a> <span class="citation" data-cites="guerra2020politicas">(<a href="#ref-guerra2020politicas" role="doc-biblioref">Guerra, Mattos e Corrêa, 2020</a>)</span>- Regressão utilizada para avaliar os efeitos de políticas de recursos humanos sobre a intenção de rotatitividade de servidores públicos</p>
<p><a href="https://www.researchgate.net/publication/376692019_Mechanical_properties_and_statistical_analysis_of_polyester_composite_reinforced_with_miriti_fibers_braided_using_crochet_technique" class="external" target="_blank">Mechanical properties and statistical analysis of polyester composite reinforced with miriti fibers braided using crochet technique</a> <span class="citation" data-cites="freires2024mechanical">(<a href="#ref-freires2024mechanical" role="doc-biblioref">Freires <em>et al.</em>, 2024</a>)</span> - Regressão utilizanda para dados experimentais obtidos de experimentos fatoriais completos.</p>
<p><a href="https://www.researchgate.net/publication/356666135_Utilizacao_do_Ambiente_R_na_assistencia_ao_metodo_de_superficie_de_resposta_para_modelagem_e_otimizacao_da_secagem_de_sementes_de_urucum" class="external" target="_blank">Utilização do Ambiente R na assistência ao método de superfície de resposta para modelagem e otimização da secagem de sementes de urucum</a> <span class="citation" data-cites="correa2021superficie">(<a href="#ref-correa2021superficie" role="doc-biblioref">Corrêa <em>et al.</em>, 2021</a>)</span> - Demonstração do uso da regressão como parte de técnicas de otimização em planejamento experimental.</p>
</section>
<section id="referências" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Referências</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-breusch1979simple" class="csl-entry" role="listitem">
BREUSCH, T. S.; PAGAN, A. R. A simple test for heteroscedasticity and random coefficient variation. <strong>Econometrica: Journal of the econometric society</strong>, p. 1287–1294, 1979.
</div>
<div id="ref-chatterjee2015regression" class="csl-entry" role="listitem">
CHATTERJEE, S.; HADI, A. S. <strong>Regression analysis by example</strong>. 5. ed. Cairo: John Wiley &amp; Sons, 2015.
</div>
<div id="ref-correa2021superficie" class="csl-entry" role="listitem">
CORRÊA, A. C. <em>et al.</em> <a href="https://doi.org/10.37885/211006441">Utiliza<span>ç</span><span>ã</span>o do Ambiente R na assist<span>ê</span>ncia ao m<span>é</span>todo de superf<span>ı́</span>cie de resposta para modelagem e otimiza<span>ç</span><span>ã</span>o da secagem de sementes de urucum</a>. <em>Em</em>: FARIA, L. J. G. DE; ANDRADE, E. L. (Eds.). <strong>Engenharia de produtos naturais: planejamento, experimenta<span>ç</span><span>ã</span>o, obten<span>ç</span><span>ã</span>o de produtos e purifica<span>ç</span><span>ã</span>o</strong>. Guajur<span>á</span>: Cient<span>ı́</span>fica Digital, 2021. p. 84–100.
</div>
<div id="ref-faraway2002practical" class="csl-entry" role="listitem">
FARAWAY, J. J. <strong><a href="http://csyue.nccu.edu.tw/Practical%20Regression%20and%20Anova%20using%20R.pdf">Practical regression and ANOVA using R</a></strong>. Bath, United Kingdom: University of Bath, 2002.
</div>
<div id="ref-car" class="csl-entry" role="listitem">
FOX, J.; WEISBERG, S. <a href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/">An <span></span>R<span></span> Companion to Applied Regression</a>. 2019.
</div>
<div id="ref-freires2024mechanical" class="csl-entry" role="listitem">
FREIRES, A. M. <em>et al.</em> Mechanical properties and statistical analysis of polyester composite reinforced with miriti fibers braided using crochet technique. <strong>Journal of Materials Research and Technology</strong>, v. 28, p. 4392–4400, 2024.
</div>
<div id="ref-guerra2020politicas" class="csl-entry" role="listitem">
GUERRA, M. H. T. DA S.; MATTOS, C. A. C.; CORRÊA, A. DE C. Pol<span>ı́</span>ticas e pr<span>á</span>ticas de gest<span>ã</span>o de pessoas e inten<span>ç</span><span>ã</span>o de rotatividade: um estudo no Instituto Federal do Par<span>á</span> (Brasil). <strong>Revista de Carreiras e Pessoas</strong>, v. 10, n. 3, 2020.
</div>
<div id="ref-gujarati2004basic" class="csl-entry" role="listitem">
GUJARATI, D. N. <strong>Basic econometrics</strong>. 4. ed. New Yok: McGraw-Hill Inc, 2004.
</div>
<div id="ref-shapiro1965analysis" class="csl-entry" role="listitem">
SHAPIRO, S. S.; WILK, M. B. An analysis of variance test for normality (complete samples). <strong>Biometrika</strong>, v. 52, n. 3-4, p. 591–611, 1965.
</div>
<div id="ref-sheather2009modern" class="csl-entry" role="listitem">
SHEATHER, S. <strong>A Modern Approach to Regression with R</strong>. New Yok: Springer Science &amp;Business Media, 2009.
</div>
<div id="ref-readxl" class="csl-entry" role="listitem">
WICKHAM, H.; BRYAN, J. <a href="https://CRAN.R-project.org/package=readxl">readxl: Read Excel Files</a>. 2023.
</div>
<div id="ref-lmtest" class="csl-entry" role="listitem">
ZEILEIS, A.; HOTHORN, T. <a href="https://CRAN.R-project.org/doc/Rnews/">Diagnostic Checking in Regression Relationships</a>. v. 2, 2002.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>